<!DOCTYPE html>
<html lang="en">

<head>
  <link rel="icon" type="image/png" href="/media/favIcon.png">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>FindMyPG - Home</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" />

  <style>
    body {
      background: #f5f7fb;
    }

    .nav-brand {
      display: flex;
      align-items: center;
      gap: 10px;
      font-weight: 700;
      color: #2563eb;
      text-decoration: none;
    }

    .brand-icon {
      width: 32px;
      height: 32px;
      border-radius: 10px;
      background: #2563eb;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      font-weight: 700;
    }

    .hero-wrap {
      padding: 42px 0 24px;
      background: #fff;
    }

    .hero-title {
      font-weight: 800;
      letter-spacing: -0.02em;
      line-height: 1.05;
      font-size: 3rem;
    }

    .hero-sub {
      color: #6b7280;
      max-width: 520px;
    }

    .hero-search .form-control {
      border-radius: 12px;
      padding: 12px 14px;
    }

    .hero-search .btn {
      border-radius: 12px;
      padding: 12px 18px;
      font-weight: 600;
    }

    .hero-img {
      width: 100%;
      border-radius: 18px;
      box-shadow: 0 16px 40px rgba(15, 23, 42, .12);
      object-fit: cover;
      min-height: 260px;
    }

    .section {
      padding: 28px 0;
    }

    .section-title {
      font-weight: 800;
      color: #111827;
    }

    .pill-chip {
      display: inline-block;
      padding: 8px 14px;
      border-radius: 999px;
      background: #fff;
      border: 1px solid #e5e7eb;
      color: #111827;
      text-decoration: none;
      font-size: .9rem;
      margin: 6px 8px 0 0;
    }

    .pill-chip:hover {
      background: #f3f4f6;
    }

    .pg-card {
      border: 0;
      border-radius: 16px;
      overflow: hidden;
      box-shadow: 0 10px 30px rgba(15, 23, 42, 0.08);
      background: #fff;
    }

    .pg-cover {
      position: relative;
      height: 150px;
      background: #d1d5db;
      overflow: hidden;
    }

    .pg-cover img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    .pg-overlay {
      position: absolute;
      inset: 0;
      background: linear-gradient(to top, rgba(0, 0, 0, .55), rgba(0, 0, 0, .0));
    }

    .pg-cover-text {
      position: absolute;
      left: 14px;
      bottom: 12px;
      right: 14px;
      color: #fff;
    }

    .pg-name {
      font-weight: 800;
    }

    .pg-price {
      font-weight: 700;
      font-size: .95rem;
    }

    .mini-badge {
      display: inline-block;
      padding: 4px 10px;
      border-radius: 999px;
      font-size: .75rem;
      border: 1px solid #e5e7eb;
      background: #f9fafb;
      color: #111827;
      margin-right: 6px;
      margin-top: 8px;
    }

    .muted {
      color: #6b7280;
    }

    .footer {
      background: #f3f4f6;
      border-top: 1px solid #e5e7eb;
      padding: 32px 0 18px;
    }

    .footer a {
      color: #6b7280;
      text-decoration: none;
    }

    .footer a:hover {
      color: #111827;
      text-decoration: underline;
    }

    .page-loader {
      position: fixed;
      inset: 0;
      background: rgba(245, 247, 251, 0.75);
      backdrop-filter: blur(3px);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 9999;
    }

    .page-loader.show {
      display: flex;
    }

    .loader-card {
      background: #fff;
      border-radius: 14px;
      padding: 18px 20px;
      box-shadow: 0 10px 30px rgba(15, 23, 42, 0.12);
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .loader-text {
      font-weight: 600;
      color: #111827;
      font-size: 0.95rem;
    }
  </style>
</head>

<body>

  <div id="pageLoader" class="page-loader" aria-hidden="true">
    <div class="loader-card">
      <div class="spinner-border text-primary" role="status" aria-label="Loading"></div>
      <div class="loader-text">Opening login‚Ä¶</div>
    </div>
  </div>

  <nav class="navbar navbar-expand-lg bg-white border-bottom">
    <div class="container py-2">
      <a class="nav-brand" href="/">
        <span class="brand-icon">üè†</span>
        <span>FindMyPG</span>
      </a>

      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#topnav">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="topnav">
        <ul class="navbar-nav ms-auto align-items-lg-center gap-lg-3">
          <li class="nav-item"><a class="nav-link" href="/pgs">Browse PGs</a></li>

          <% if (typeof user !=="undefined" && user) { %>
            <li class="nav-item"><a class="nav-link" href="/profile">Hi, <%= user.name %></a></li>
            <li class="nav-item">
              <form action="/logout" method="POST" class="d-inline">
                <button class="btn btn-outline-secondary btn-sm" type="submit">Logout</button>
              </form>
            </li>
            <% } else { %>
              <li class="nav-item"><a class="nav-link" href="/login" id="loginLink">Login</a></li>
              <% } %>

                <li class="nav-item">
                  <a class="btn btn-outline-primary btn-sm" href="/register/owner">List your PG</a>
                </li>
        </ul>
      </div>
    </div>
  </nav>

  <section class="hero-wrap">
    <div class="container">
      <div class="row align-items-center g-4">
        <div class="col-12 col-lg-6">
          <div class="hero-title">Find your perfect<br />PG, hassle-free.</div>
          <p class="hero-sub mt-3">
            Your ideal home away from home is just a search away. Discover comfortable and affordable
            accommodations tailored to your needs.
          </p>

          <form action="/pgs" method="GET" class="hero-search mt-3">
            <div class="d-flex gap-2">
              <input class="form-control" type="text" name="q" placeholder="Search by area or landmark..."
                value="<%= typeof q !== 'undefined' ? q : '' %>" />
              <button class="btn btn-primary" type="submit">Search</button>
            </div>
          </form>
        </div>

        <div class="col-12 col-lg-6">
          <img class="hero-img"
            src="<%= (typeof heroImage !== 'undefined' && heroImage) ? heroImage : 'https://images.unsplash.com/photo-1505691938895-1758d7feb511?auto=format&fit=crop&w=1200&q=80' %>"
            alt="PG interior" />
        </div>
      </div>
    </div>
  </section>

  <section class="section">
    <div class="container">
      <h4 class="section-title mb-2">Popular Areas</h4>
      <div>
        <% (popularAreas || ["PuriShimla","Shimlapuri","dianaludhi","ludhiana","Katraj","Pimple Saudagar","Aundh"]).forEach(a=> { %>
          <a class="pill-chip" href="/pgs?area=<%= encodeURIComponent(a) %>">
            <%= a %>
          </a>
          <% }) %>
      </div>
    </div>
  </section>

  <section class="section pt-0">
    <div class="container">
      <h4 class="section-title mb-3">Featured PGs</h4>

      <div class="row g-3">
        <% if (!featuredPgs || featuredPgs.length===0) { %>
          <div class="col-12">
            <div class="alert alert-light border mb-0">No featured PGs yet.</div>
          </div>
          <% } %>

            <% (featuredPgs || []).forEach(pg=> { %>
              <div class="col-12 col-md-6 col-lg-4 col-xl-3">
                <a href="/pgs/<%= pg._id %>" class="text-decoration-none">
                  <div class="pg-card">
                    <div class="pg-cover">
                      <img src="<%= pg.cover_url || 'https://images.unsplash.com/photo-1522770179533-24471fcdba45' %>"
                        alt="<%= pg.name %>">
                      <div class="pg-overlay"></div>
                      <div class="pg-cover-text">
                        <div class="pg-name">
                          <%= pg.name %>
                        </div>
                        <div class="pg-price">Starting from ‚Çπ<%= pg.min_price %>/month</div>
                      </div>
                    </div>

                    <div class="p-3">
                      <div class="muted" style="font-size:.9rem;">
                        <%= pg.area %>
                          <% if (pg.city) { %>, <%= pg.city %>
                              <% } %>
                      </div>

                      <% if (pg.foodLabel) { %>
                        <div class="mt-2">
                          <span class="mini-badge">
                            <%= pg.foodLabel %>
                          </span>
                        </div>
                        <% } %>

                          <div class="mt-1">
                            <% (pg.amenities || []).slice(0, 4).forEach(am=> { %>
                              <span class="mini-badge">
                                <%= am %>
                              </span>
                              <% }) %>
                          </div>
                    </div>
                  </div>
                </a>
              </div>
              <% }) %>
      </div>
    </div>
  </section>

  <footer class="footer">
    <div class="container">
      <div class="row g-4">
        <div class="col-12 col-lg-4">
          <div class="d-flex align-items-center gap-2 mb-2">
            <span class="brand-icon">üè†</span>
            <span class="fw-bold" style="color:#2563eb;">FindMyPG</span>
          </div>
          <div class="muted">
            Find your perfect paying guest accommodation with ease.
          </div>

          <div class="d-flex gap-3 mt-3">
            <a href="#" aria-label="Facebook" class="text-muted fs-5"><i class="bi bi-facebook"></i></a>
            <a href="#" aria-label="X" class="text-muted fs-5"><i class="bi bi-twitter-x"></i></a>
            <a href="#" aria-label="Instagram" class="text-muted fs-5"><i class="bi bi-instagram"></i></a>
            <a href="#" aria-label="LinkedIn" class="text-muted fs-5"><i class="bi bi-linkedin"></i></a>
          </div>
        </div>

        <div class="col-6 col-lg-2">
          <div class="fw-semibold mb-2">Company</div>
          <div class="d-grid gap-1">
            <a href="/about">About Us</a>
            <a href="/careers">Careers</a>
            <a href="/blog">Blog</a>
          </div>
        </div>

        <div class="col-6 col-lg-3">
          <div class="fw-semibold mb-2">Support</div>
          <div class="d-grid gap-1">
            <a href="/help">Help Center</a>
            <a href="/contact">Contact Us</a>
          </div>
        </div>

        <div class="col-6 col-lg-3">
          <div class="fw-semibold mb-2">Legal</div>
          <div class="d-grid gap-1">
            <a href="/privacy">Privacy Policy</a>
            <a href="/terms">Terms of Service</a>
          </div>
        </div>
      </div>

      <hr class="my-4">

      <div class="text-center muted" style="font-size:.9rem;">
        ¬© <%= new Date().getFullYear() %> FindMyPG. All rights reserved.
      </div>
    </div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const loginLink = document.getElementById('loginLink');
      const loader = document.getElementById('pageLoader');

      if (!loginLink || !loader) return;

      loginLink.addEventListener('click', function (e) {
        if (e.ctrlKey || e.metaKey || e.shiftKey || e.altKey || e.button === 1) return;

        e.preventDefault();

        loader.classList.add('show');
        loader.setAttribute('aria-hidden', 'false');

        setTimeout(() => {
          window.location.href = loginLink.getAttribute('href');
        }, 180);
      });
    });
  </script>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const loginLink = document.getElementById('loginLink');
      const loader = document.getElementById('pageLoader');

      if (!loader) return;

      window.addEventListener('pageshow', function () {
        loader.classList.remove('show');
        loader.setAttribute('aria-hidden', 'true');
      });

      if (!loginLink) return;

      loginLink.addEventListener('click', function (e) {
        if (e.ctrlKey || e.metaKey || e.shiftKey || e.altKey || e.button === 1) return;

        e.preventDefault();

        loader.classList.add('show');
        loader.setAttribute('aria-hidden', 'false');

        setTimeout(() => {
          window.location.href = loginLink.getAttribute('href');
        }, 180);
      });
    });
  </script>

</body>

</html>